<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>å­¦æœ¯ç‰ˆ - Markdown è½¬ Word</title>
    <link rel="stylesheet" href="shared.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/styles/github.min.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.9/katex.min.css">
    <style>
        :root {
            --primary-color: #f5576c;
            --primary-light: #fef2f3;
            --header-bg: linear-gradient(135deg, #f093fb 0%, #f5576c 100%);
            --toolbar-bg: #fff;
            --border-color: #e5e7eb;
            --text-primary: #1f2937;
            --text-secondary: #6b7280;
            --text-muted: #9ca3af;
            --hover-bg: #f3f4f6;
            --btn-secondary-bg: #f9fafb;
            --editor-bg: #fff;
            --preview-bg: #fff;
            --panel-header-bg: #f9fafb;
            --blockquote-bg: #fef2f3;
            --code-bg: #f3f4f6;
            --pre-bg: #1f2937;
            --pre-text: #e5e7eb;
            --table-header-bg: #f9fafb;
            --modal-bg: #fff;
            --input-bg: #fff;
            --toc-bg: #fef2f3;
            --status-bar-bg: #f9fafb;
            --line-numbers-bg: #f9fafb;
        }
        .header {
            background: var(--header-bg);
            color: white;
        }
        .header .logo, .header .back-btn { color: white; }
        .header .btn-secondary { background: rgba(255,255,255,0.2); color: white; border: none; }
        .header .btn-secondary:hover { background: rgba(255,255,255,0.3); }
        
        /* å…¬å¼æ ·å¼ */
        .katex-display {
            margin: 1em 0;
            overflow-x: auto;
        }
    </style>
</head>
<body>
    <div class="container">
        <header class="header">
            <div class="header-left">
                <a href="index.html" class="back-btn">â†</a>
                <span class="logo">ğŸ“ å­¦æœ¯ç‰ˆ</span>
            </div>
            <div class="header-right">
                <label class="btn btn-secondary">
                    <input type="file" id="fileInput" accept=".md,.markdown,.txt" hidden>
                    ğŸ“ ä¸Šä¼ 
                </label>
                <button id="tocBtn" class="btn btn-secondary">ğŸ“‘ ç”Ÿæˆç›®å½•</button>
                <button id="styleBtn" class="btn btn-secondary">ğŸ¨ æ ·å¼</button>
                <button id="downloadBtn" class="btn btn-success">â¬‡ï¸ ä¸‹è½½ Word</button>
            </div>
        </header>

        <div class="toolbar">
            <div class="toolbar-group">
                <button class="toolbar-btn" data-action="heading" title="æ ‡é¢˜">H</button>
                <button class="toolbar-btn" data-action="bold" title="ç²—ä½“">B</button>
                <button class="toolbar-btn" data-action="italic" title="æ–œä½“">I</button>
                <span class="toolbar-divider"></span>
                <button class="toolbar-btn" data-action="formula" title="è¡Œå†…å…¬å¼">âˆ‘</button>
                <button class="toolbar-btn" data-action="formula-block" title="å…¬å¼å—">âˆ«</button>
                <span class="toolbar-divider"></span>
                <button class="toolbar-btn" data-action="image" title="æ’å…¥å›¾ç‰‡">ğŸ–¼ï¸</button>
                <button class="toolbar-btn" data-action="table" title="æ’å…¥è¡¨æ ¼">ğŸ“Š</button>
                <button class="toolbar-btn" data-action="quote" title="å¼•ç”¨">â</button>
                <span class="toolbar-divider"></span>
                <button class="toolbar-btn" data-action="ref" title="å‚è€ƒæ–‡çŒ®">[1]</button>
            </div>
            <div class="toolbar-group">
                <select id="templateSelect">
                    <option value="thesis">å­¦ä½è®ºæ–‡</option>
                    <option value="paper">æœŸåˆŠè®ºæ–‡</option>
                    <option value="report">ç ”ç©¶æŠ¥å‘Š</option>
                </select>
            </div>
        </div>

        <div class="main-content">
            <div class="editor-panel">
                <div class="panel-header">
                    <span>Markdown ç¼–è¾‘å™¨</span>
                    <span id="charCount">0 å­—ç¬¦</span>
                </div>
                <div class="editor-wrapper">
                    <div class="line-numbers" id="lineNumbers">1</div>
                    <textarea id="markdownInput" placeholder="åœ¨æ­¤è¾“å…¥ Markdown å†…å®¹...

æ”¯æŒ LaTeX å…¬å¼ï¼š
- è¡Œå†…å…¬å¼ï¼š$E = mc^2$
- å…¬å¼å—ï¼š
$$
\int_{-\infty}^{\infty} e^{-x^2} dx = \sqrt{\pi}
$$"></textarea>
                </div>
            </div>
            <div class="preview-panel">
                <div class="panel-header">
                    <span>å®æ—¶é¢„è§ˆ</span>
                    <label><input type="checkbox" id="showToc" checked> æ˜¾ç¤ºç›®å½•</label>
                </div>
                <div id="preview" class="preview-content"></div>
            </div>
        </div>

        <div class="status-bar">
            <div class="status-item">
                <span>å­¦æœ¯ç‰ˆ</span>
                <span>|</span>
                <span id="wordCount">0 è¯</span>
            </div>
            <div class="status-item">
                <span>æ”¯æŒ LaTeX å…¬å¼</span>
            </div>
        </div>
    </div>

    <!-- æ ·å¼å¼¹çª— -->
    <div id="styleModal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h2>ğŸ¨ è®ºæ–‡æ ·å¼è®¾ç½®</h2>
                <button class="close-btn" id="closeModal">&times;</button>
            </div>
            <div class="modal-body">
                <div class="style-section">
                    <h3>è®ºæ–‡æ¨¡æ¿</h3>
                    <div class="template-grid">
                        <button class="template-btn active" data-template="thesis">å­¦ä½è®ºæ–‡</button>
                        <button class="template-btn" data-template="paper">æœŸåˆŠè®ºæ–‡</button>
                        <button class="template-btn" data-template="report">ç ”ç©¶æŠ¥å‘Š</button>
                        <button class="template-btn" data-template="book">ä¹¦ç±ç« èŠ‚</button>
                    </div>
                </div>
                <div class="style-section">
                    <h3>å­—ä½“è®¾ç½®</h3>
                    <div class="style-row">
                        <label>ä¸­æ–‡æ­£æ–‡</label>
                        <select id="bodyFont">
                            <option value="å®‹ä½“" selected>å®‹ä½“</option>
                            <option value="ä»¿å®‹">ä»¿å®‹</option>
                            <option value="æ¥·ä½“">æ¥·ä½“</option>
                        </select>
                    </div>
                    <div class="style-row">
                        <label>è‹±æ–‡æ­£æ–‡</label>
                        <select id="engFont">
                            <option value="Times New Roman" selected>Times New Roman</option>
                            <option value="Arial">Arial</option>
                        </select>
                    </div>
                    <div class="style-row">
                        <label>æ­£æ–‡å­—å·</label>
                        <select id="bodySize">
                            <option value="10.5">äº”å· (10.5pt)</option>
                            <option value="12" selected>å°å›› (12pt)</option>
                        </select>
                    </div>
                </div>
                <div class="style-section">
                    <h3>æ®µè½è®¾ç½®</h3>
                    <div class="style-row">
                        <label>è¡Œé—´è·</label>
                        <select id="lineSpacing">
                            <option value="1.5">1.5å€</option>
                            <option value="2" selected>åŒå€</option>
                        </select>
                    </div>
                    <div class="style-row">
                        <label>é¦–è¡Œç¼©è¿›</label>
                        <select id="firstIndent">
                            <option value="2" selected>2å­—ç¬¦</option>
                            <option value="0">æ— ç¼©è¿›</option>
                        </select>
                    </div>
                </div>
            </div>
            <div class="modal-footer">
                <button id="resetStyle" class="btn btn-secondary">é‡ç½®</button>
                <button id="applyStyle" class="btn btn-primary">åº”ç”¨</button>
            </div>
        </div>
    </div>

    <script src="https://cdnjs.cloudflare.com/ajax/libs/marked/12.0.0/marked.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/highlight.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.9/katex.min.js"></script>
    <script src="https://unpkg.com/docx@8.5.0/build/index.umd.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/FileSaver.js/2.0.5/FileSaver.min.js"></script>
    <script src="academic.js"></script>
</body>
</html>
