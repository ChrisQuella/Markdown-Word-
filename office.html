<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>åŠå…¬ç‰ˆ - Markdown è½¬ Word</title>
    <link rel="stylesheet" href="shared.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/styles/github.min.css">
    <style>
        :root {
            --primary-color: #38d9a9;
            --primary-light: #e6fcf5;
            --header-bg: linear-gradient(135deg, #43e97b 0%, #38f9d7 100%);
            --toolbar-bg: #fff;
            --border-color: #e5e7eb;
            --text-primary: #1f2937;
            --text-secondary: #6b7280;
            --text-muted: #9ca3af;
            --hover-bg: #f3f4f6;
            --btn-secondary-bg: #f9fafb;
            --editor-bg: #fff;
            --preview-bg: #fff;
            --panel-header-bg: #f9fafb;
            --blockquote-bg: #e6fcf5;
            --code-bg: #f3f4f6;
            --pre-bg: #1f2937;
            --pre-text: #e5e7eb;
            --table-header-bg: #f9fafb;
            --modal-bg: #fff;
            --input-bg: #fff;
            --toc-bg: #e6fcf5;
            --status-bar-bg: #f9fafb;
            --line-numbers-bg: #f9fafb;
        }
        .header {
            background: var(--header-bg);
            color: white;
        }
        .header .logo, .header .back-btn { color: white; }
        .header .btn-secondary { background: rgba(255,255,255,0.2); color: white; border: none; }
        
        /* å¯è§†åŒ–å·¥å…·æ  */
        .visual-toolbar {
            display: flex;
            flex-wrap: wrap;
            gap: 4px;
            padding: 12px 20px;
            background: #fff;
            border-bottom: 1px solid var(--border-color);
        }
        .visual-btn {
            width: 36px;
            height: 36px;
            border: 1px solid #e5e7eb;
            background: #fff;
            border-radius: 6px;
            cursor: pointer;
            font-size: 16px;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: all 0.2s;
        }
        .visual-btn:hover {
            background: #f3f4f6;
            border-color: var(--primary-color);
        }
        .visual-btn.active {
            background: var(--primary-light);
            border-color: var(--primary-color);
        }
        .toolbar-sep {
            width: 1px;
            height: 36px;
            background: #e5e7eb;
            margin: 0 8px;
        }
        
        /* å›¾ç‰‡æ‹–æ‹½åŒºåŸŸ */
        .drop-zone {
            border: 2px dashed #e5e7eb;
            border-radius: 8px;
            padding: 20px;
            text-align: center;
            margin: 10px 0;
            transition: all 0.2s;
        }
        .drop-zone.dragover {
            border-color: var(--primary-color);
            background: var(--primary-light);
        }
        .drop-zone-text {
            color: var(--text-muted);
            font-size: 14px;
        }
        
        /* å¯¼å‡ºé€‰é¡¹ */
        .export-options {
            display: flex;
            gap: 10px;
        }
    </style>
</head>
<body>
    <div class="container">
        <header class="header">
            <div class="header-left">
                <a href="index.html" class="back-btn">â†</a>
                <span class="logo">ğŸ’¼ åŠå…¬ç‰ˆ</span>
            </div>
            <div class="header-right">
                <label class="btn btn-secondary">
                    <input type="file" id="fileInput" accept=".md,.markdown,.txt" hidden>
                    ğŸ“ æ‰“å¼€æ–‡ä»¶
                </label>
                <button id="styleBtn" class="btn btn-secondary">ğŸ¨ æ ·å¼</button>
                <div class="export-options">
                    <button id="downloadWord" class="btn btn-success">ğŸ“„ Word</button>
                    <button id="downloadPdf" class="btn btn-primary">ğŸ“‘ PDF</button>
                </div>
            </div>
        </header>

        <!-- å¯è§†åŒ–å·¥å…·æ  -->
        <div class="visual-toolbar">
            <button class="visual-btn" data-action="h1" title="ä¸€çº§æ ‡é¢˜">H1</button>
            <button class="visual-btn" data-action="h2" title="äºŒçº§æ ‡é¢˜">H2</button>
            <button class="visual-btn" data-action="h3" title="ä¸‰çº§æ ‡é¢˜">H3</button>
            <div class="toolbar-sep"></div>
            <button class="visual-btn" data-action="bold" title="ç²—ä½“"><b>B</b></button>
            <button class="visual-btn" data-action="italic" title="æ–œä½“"><i>I</i></button>
            <button class="visual-btn" data-action="strike" title="åˆ é™¤çº¿"><s>S</s></button>
            <div class="toolbar-sep"></div>
            <button class="visual-btn" data-action="ul" title="æ— åºåˆ—è¡¨">â€¢</button>
            <button class="visual-btn" data-action="ol" title="æœ‰åºåˆ—è¡¨">1.</button>
            <button class="visual-btn" data-action="quote" title="å¼•ç”¨">â</button>
            <div class="toolbar-sep"></div>
            <button class="visual-btn" data-action="table" title="è¡¨æ ¼">ğŸ“Š</button>
            <button class="visual-btn" data-action="image" title="å›¾ç‰‡">ğŸ–¼ï¸</button>
            <button class="visual-btn" data-action="link" title="é“¾æ¥">ğŸ”—</button>
            <button class="visual-btn" data-action="hr" title="åˆ†å‰²çº¿">â€”</button>
            <div class="toolbar-sep"></div>
            <button class="visual-btn" data-action="undo" title="æ’¤é”€">â†©ï¸</button>
            <button class="visual-btn" data-action="redo" title="é‡åš">â†ªï¸</button>
        </div>

        <div class="main-content">
            <div class="editor-panel">
                <div class="panel-header">
                    <span>ç¼–è¾‘åŒº</span>
                    <span id="charCount">0 å­—</span>
                </div>
                <textarea id="markdownInput" placeholder="åœ¨æ­¤è¾“å…¥å†…å®¹ï¼Œæˆ–ä½¿ç”¨ä¸Šæ–¹å·¥å…·æ å¿«é€Ÿæ’å…¥æ ¼å¼...

æç¤ºï¼š
â€¢ ç‚¹å‡»å·¥å…·æ æŒ‰é’®å¯å¿«é€Ÿæ’å…¥æ ¼å¼
â€¢ æ”¯æŒæ‹–æ‹½å›¾ç‰‡åˆ°ç¼–è¾‘åŒº
â€¢ å¯å¯¼å‡ºä¸º Word æˆ– PDF æ ¼å¼"></textarea>
            </div>
            <div class="preview-panel">
                <div class="panel-header">
                    <span>é¢„è§ˆ</span>
                    <select id="templateSelect">
                        <option value="default">é»˜è®¤æ ·å¼</option>
                        <option value="business">å•†åŠ¡æŠ¥å‘Š</option>
                        <option value="simple">ç®€çº¦é£æ ¼</option>
                        <option value="formal">æ­£å¼å…¬æ–‡</option>
                    </select>
                </div>
                <div id="preview" class="preview-content"></div>
            </div>
        </div>

        <div class="status-bar">
            <div class="status-item">
                <span id="wordCount">0 è¯</span>
                <span>|</span>
                <span id="readTime">é˜…è¯»çº¦ 0 åˆ†é’Ÿ</span>
            </div>
            <div class="status-item">
                <span>åŠå…¬ç‰ˆ</span>
            </div>
        </div>
    </div>

    <!-- å›¾ç‰‡ä¸Šä¼ å¼¹çª— -->
    <div id="imageModal" class="modal">
        <div class="modal-content" style="max-width: 400px;">
            <div class="modal-header">
                <h2>ğŸ–¼ï¸ æ’å…¥å›¾ç‰‡</h2>
                <button class="close-btn" id="closeImageModal">&times;</button>
            </div>
            <div class="modal-body">
                <div class="drop-zone" id="dropZone">
                    <div class="drop-zone-text">
                        æ‹–æ‹½å›¾ç‰‡åˆ°æ­¤å¤„<br>æˆ–ç‚¹å‡»é€‰æ‹©æ–‡ä»¶
                    </div>
                    <input type="file" id="imageInput" accept="image/*" hidden>
                </div>
                <div class="style-row" style="margin-top: 16px;">
                    <label>å›¾ç‰‡æè¿°</label>
                    <input type="text" id="imageAlt" placeholder="å›¾ç‰‡æè¿°æ–‡å­—" style="flex:1; margin-left: 10px;">
                </div>
            </div>
            <div class="modal-footer">
                <button id="cancelImage" class="btn btn-secondary">å–æ¶ˆ</button>
                <button id="insertImage" class="btn btn-primary">æ’å…¥</button>
            </div>
        </div>
    </div>

    <!-- æ ·å¼å¼¹çª— -->
    <div id="styleModal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h2>ğŸ¨ æ–‡æ¡£æ ·å¼</h2>
                <button class="close-btn" id="closeModal">&times;</button>
            </div>
            <div class="modal-body">
                <div class="style-section">
                    <h3>æ–‡æ¡£æ¨¡æ¿</h3>
                    <div class="template-grid">
                        <button class="template-btn active" data-template="default">é»˜è®¤æ ·å¼</button>
                        <button class="template-btn" data-template="business">å•†åŠ¡æŠ¥å‘Š</button>
                        <button class="template-btn" data-template="simple">ç®€çº¦é£æ ¼</button>
                        <button class="template-btn" data-template="formal">æ­£å¼å…¬æ–‡</button>
                    </div>
                </div>
                <div class="style-section">
                    <h3>å­—ä½“è®¾ç½®</h3>
                    <div class="style-row">
                        <label>æ­£æ–‡å­—ä½“</label>
                        <select id="bodyFont">
                            <option value="å¾®è½¯é›…é»‘">å¾®è½¯é›…é»‘</option>
                            <option value="å®‹ä½“">å®‹ä½“</option>
                            <option value="é»‘ä½“">é»‘ä½“</option>
                            <option value="ä»¿å®‹">ä»¿å®‹</option>
                        </select>
                    </div>
                    <div class="style-row">
                        <label>æ­£æ–‡å­—å·</label>
                        <select id="bodySize">
                            <option value="10.5">äº”å· (10.5pt)</option>
                            <option value="12" selected>å°å›› (12pt)</option>
                            <option value="14">å››å· (14pt)</option>
                        </select>
                    </div>
                </div>
                <div class="style-section">
                    <h3>é¡µé¢è®¾ç½®</h3>
                    <div class="style-row">
                        <label>è¡Œé—´è·</label>
                        <select id="lineSpacing">
                            <option value="1">å•å€</option>
                            <option value="1.5" selected>1.5å€</option>
                            <option value="2">åŒå€</option>
                        </select>
                    </div>
                    <div class="style-row">
                        <label>é¡µè¾¹è·</label>
                        <select id="pageMargin">
                            <option value="normal" selected>æ™®é€š</option>
                            <option value="narrow">çª„</option>
                            <option value="wide">å®½</option>
                        </select>
                    </div>
                </div>
                <div class="style-section">
                    <h3>é¡µçœ‰é¡µè„š</h3>
                    <div class="style-row">
                        <label>é¡µçœ‰æ–‡å­—</label>
                        <input type="text" id="headerText" placeholder="ç•™ç©ºåˆ™ä¸æ˜¾ç¤º">
                    </div>
                    <div class="style-row">
                        <label>æ˜¾ç¤ºé¡µç </label>
                        <select id="showPageNum">
                            <option value="yes">æ˜¯</option>
                            <option value="no">å¦</option>
                        </select>
                    </div>
                </div>
            </div>
            <div class="modal-footer">
                <button id="resetStyle" class="btn btn-secondary">é‡ç½®</button>
                <button id="applyStyle" class="btn btn-primary">åº”ç”¨</button>
            </div>
        </div>
    </div>

    <script src="https://cdnjs.cloudflare.com/ajax/libs/marked/12.0.0/marked.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/highlight.min.js"></script>
    <script src="https://unpkg.com/docx@8.5.0/build/index.umd.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/FileSaver.js/2.0.5/FileSaver.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/html2pdf.js/0.10.1/html2pdf.bundle.min.js"></script>
    <script src="office.js"></script>
</body>
</html>
